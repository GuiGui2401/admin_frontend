"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[3207],{33207:(e,t,s)=>{s.r(t),s.d(t,{default:()=>N});var a=s(9950),n=s(28429),i=s(49348),d=s(25887),l=s(20567),u=s(87094),r=s(41988),o=s(40202),c=s(37437),p=s(25933),h=s(48538),m=s(90650),x=s(91854),_=s(74623),b=s(67231),v=s(47992),f=s(70030),j=s(59051),A=s.n(j),y=s(39095),g=s(96591),q=s(44414);const N=()=>{const{t:e}=(0,f.B)(),{activeMenu:t}=(0,x.d4)((e=>e.menu),x.bN),s=(0,x.wA)(),[j]=d.A.useForm(),N=(0,n.Zp)(),{id:w}=(0,n.g)(),[I,S]=(0,a.useState)(!1),[Y,k]=(0,a.useState)(!1);(0,a.useEffect)((()=>()=>{const e=j.getFieldsValue(!0);e.expired_at=JSON.stringify(null===e||void 0===e?void 0:e.expired_at),s((0,_.Ok)({activeMenu:t,data:e}))}),[]);const M=e=>{k(!0),y.A.getById(e).then((e=>{!function(e){j.setFieldsValue({...e,shop_product_id:F(e.shop_product),bonus_product_id:F(e.bonus_product),expired_at:A()(e.expired_at,"YYYY-MM-DD")}),k(!1)}(e.data)})).finally((()=>s((0,_.km)(t))))};function O(e){const t={search:e,perPage:10};return b.A.getAll(t).then((e=>e.data.map((e=>{var t,s;return{label:null===(t=e.product)||void 0===t||null===(s=t.translation)||void 0===s?void 0:s.title,value:null===e||void 0===e?void 0:e.id}}))))}function F(e){var t,s;return{label:(null===e||void 0===e||null===(t=e.product)||void 0===t||null===(s=t.translation)||void 0===s?void 0:s.title)||"",value:null===e||void 0===e?void 0:e.id}}(0,a.useEffect)((()=>{t.refetch&&M(w)}),[t.refetch]);return(0,q.jsx)(l.A,{title:e("edit.bonus"),className:"h-100",children:Y?(0,q.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,q.jsx)(m.A,{size:"large",className:"py-5"})}):(0,q.jsxs)(d.A,{name:"bonus-edit",layout:"vertical",onFinish:a=>{S(!0);const n={expired_at:A()(a.expired_at).format("YYYY-MM-DD"),status:a.status,shop_product_id:a.shop_product_id.value,bonus_product_id:a.bonus_product_id.value,bonus_quantity:a.bonus_quantity,shop_product_quantity:a.shop_product_quantity};y.A.update(w,n).then((()=>{const a="seller/bonus/product";i.oR.success(e("successfully.updated")),s((0,_.EK)({...t,nextUrl:a})),N(`/${a}`),s((0,g.q)())})).finally((()=>S(!1)))},form:j,initialValues:{active:!0,...t.data,...(()=>{var e,s;if(null===(e=t.data)||void 0===e||!e.expired_at)return{};const a=JSON.parse(null===(s=t.data)||void 0===s?void 0:s.expired_at);return{expired_at:A()(a,"HH:mm:ss")}})()},className:"d-flex flex-column h-100",children:[(0,q.jsxs)(u.A,{gutter:12,children:[(0,q.jsx)(r.A,{span:12,children:(0,q.jsx)(d.A.Item,{label:e("products"),name:"shop_product_id",rules:[{required:!0,message:e("required")}],children:(0,q.jsx)(v.G,{fetchOptions:O,debounceTimeout:200})})}),(0,q.jsx)(r.A,{span:12,children:(0,q.jsx)(d.A.Item,{label:e("product.quantity"),name:"shop_product_quantity",rules:[{required:!0,message:e("required")}],children:(0,q.jsx)(o.A,{className:"w-100",min:0})})}),(0,q.jsx)(r.A,{span:12,children:(0,q.jsx)(d.A.Item,{label:e("bonus.product"),name:"bonus_product_id",rules:[{required:!0,message:e("required")}],children:(0,q.jsx)(v.G,{fetchOptions:O,debounceTimeout:200})})}),(0,q.jsx)(r.A,{span:12,children:(0,q.jsx)(d.A.Item,{label:e("bonus.product.quantity"),name:"bonus_quantity",rules:[{required:!0,message:e("required")}],children:(0,q.jsx)(o.A,{className:"w-100",min:0})})}),(0,q.jsx)(r.A,{span:12,children:(0,q.jsx)(d.A.Item,{name:"expired_at",label:e("expired.at"),rules:[{required:!0,message:e("required")}],children:(0,q.jsx)(c.A,{className:"w-100",placeholder:"",disabledDate:e=>A()().add(-1,"days")>=e})})}),(0,q.jsx)(r.A,{span:12,children:(0,q.jsx)(d.A.Item,{label:e("active"),name:"status",valuePropName:"checked",children:(0,q.jsx)(p.A,{})})})]}),(0,q.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,q.jsx)("div",{className:"pb-5",children:(0,q.jsx)(h.A,{type:"primary",htmlType:"submit",loading:I,disabled:I,children:e("submit")})})})]})})}},47992:(e,t,s)=>{s.d(t,{G:()=>r});var a=s(9950),n=s(95491),i=s.n(n),d=s(99674),l=s(90650),u=s(44414);const r=e=>{let{fetchOptions:t,debounceTimeout:s=400,...n}=e;const[r,o]=(0,a.useState)(!1),[c,p]=(0,a.useState)([]),h=(0,a.useMemo)((()=>i()((e=>{p([]),o(!0),t(e).then((e=>{p(e),o(!1)}))}),s)),[t,s]);return(0,u.jsx)(d.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:h,notFoundContent:r?(0,u.jsx)(l.A,{size:"small"}):"no results",...n,options:c,onFocus:()=>{c.length||h("")}})}}}]);