"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[1920],{1920:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ue});var d=a(9950),s=a(33022),n=a(62863),r=a(80737),i=a(48538),o=a(20567),l=a(73092),c=a(28429),u=a(12678),v=a(24513),h=a(13700),p=a(53387),g=a(66330),x=a(69660),m=a(91854),A=a(74623),j=a(70030),b=a(88986),f=a(8168),y=a(8297),_=a(51242),w=a(53774),k=a(47992),I=a(66209),C=a(28645),S=a(54209),D=a(99985),M=a(12916),$=a(36059),T=a(44414);const O=e=>{let{children:t,title:a,name:d,isDropDisabled:s,statistic:n,loading:i=!1,reloadCurrentOrder:o}=e;const{t:l}=(0,j.B)();return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(D.A,{message:(0,T.jsxs)(r.A,{children:[(0,T.jsx)(S.A,{size:20,style:{cursor:"pointer"},spin:i,onClick:()=>o(d)}),l(a),(0,T.jsx)(M.A,{children:(null===n||void 0===n?void 0:n[d])||(0,T.jsx)(S.A,{size:20,spin:i})})]}),className:`mb-4 ${d}`,style:{textAlign:"center",fontSize:16,textTransform:"capitalize"}}),(0,T.jsx)($.gL,{droppableId:d,isDropDisabled:s,children:e=>(0,T.jsx)("div",{ref:e.innerRef,className:"h-screen",style:{opacity:s?.6:1},children:(0,T.jsxs)(T.Fragment,{children:[t,e.placeholder]})})})]})};var Y=a(90650),N=a(69466),P=a(20626),E=a(2260),F=a(80415),z=a(73041),B=a(49348),H=a(57056),R=a(50198),G=a(76074),L=a(18411),V=a(46809),X=a(4399),K=a(98114),q=a(79378),J=a(80575),U=a(75871),Z=a(63611),Q=a(63620);const{Meta:W}=o.A,ee=e=>{var t,a,d,s,n,i,l,c,h;let{data:p,goToEdit:g,goToShow:x,getInvoiceFile:m,loading:A}=e;const j=[{title:"Number of products",icon:(0,T.jsx)(R.A,{}),data:null===p||void 0===p?void 0:p.order_details_count},{title:"Deliveryman",icon:(0,T.jsx)(G.A,{}),data:`${(null===(t=p.deliveryman)||void 0===t?void 0:t.firstname)||"-"} ${(null===(a=p.deliveryman)||void 0===a?void 0:a.lastname)||"-"}`},{title:"Amount",icon:(0,T.jsx)(L.A,{}),data:(0,w.A)(p.price,null===(d=p.currency)||void 0===d?void 0:d.symbol)},{title:"Payment type",icon:(0,T.jsx)(V.A,{}),data:(null===(s=p.transaction)||void 0===s||null===(n=s.payment_system)||void 0===n?void 0:n.tag)||"-"},{title:"Payment status",icon:(0,T.jsx)(X.A,{}),data:(null===(i=p.transaction)||void 0===i?void 0:i.status)||"-"}];return(0,T.jsx)(o.A,{actions:[(0,T.jsx)(u.A,{onClick:()=>x(p)},"setting"),(0,T.jsx)(v.A,{onClick:()=>g(p)},"edit"),(0,T.jsx)(K.A,{onClick:()=>m(p)},"ellipsis")],className:"order-card",children:(0,T.jsxs)(J.A,{loading:A,avatar:!0,active:!0,children:[(0,T.jsx)(W,{avatar:(0,T.jsx)(U.A,{src:Q.sE+(null===(l=p.user)||void 0===l?void 0:l.img),icon:(0,T.jsx)(q.A,{})}),description:`#${p.id}`,title:`${(null===(c=p.user)||void 0===c?void 0:c.firstname)||"-"} ${(null===(h=p.user)||void 0===h?void 0:h.lastname)||"-"}`}),(0,T.jsx)(Z.Ay,{itemLayout:"horizontal",dataSource:j,renderItem:(e,t)=>(0,T.jsx)(Z.Ay.Item,{children:(0,T.jsxs)(r.A,{children:[e.icon,`${e.title}:  ${e.data}`]})},t)})]})})},te=["new","accepted","ready","on_a_way","delivered","canceled"],ae=e=>{let{goToEdit:t,goToShow:a,fetchOrderAllItem:s,fetchOrders:n,statistic:r,getInvoiceFile:i}=e;const o=(0,m.wA)(),{items:l}=(0,m.d4)((e=>e.sellerOrders),m.bN),c=(0,m.d4)((e=>e.sellerOrders),m.bN),[u,v]=(0,d.useState)(""),[h,p]=(0,d.useState)({}),[g,x]=(0,d.useState)({}),A=e=>{if(!e.destination)return;if(e.destination&&h.source.droppableId!==e.destination.droppableId){const d=e.source.droppableId,s=e.destination.droppableId;t=e.draggableId,a={status:e.destination.droppableId},H.A.updateStatus(t,a).then((e=>{B.oR.success(`#${t} order status changed`)})).catch((e=>{B.oR.error(`#${t} order status has not changed`)})),(0,m.vA)((()=>{o((0,P.ME)({status:d,qty:r[d]-1})),o((0,P.ME)({status:s,qty:r[s]+1}))}))}var t,a;const d={...l},s=d[e.source.droppableId],[n,i]=((e,t)=>{const a=Array.from(e),[d]=a.splice(t,1);return[d,a]})(s,e.source.index);d[e.source.droppableId]=i;const c=d[e.destination.droppableId];d[e.destination.droppableId]=((e,t,a)=>{const d=Array.from(e);return d.splice(t,0,a),d})(c,e.destination.index,n),o((0,P.jb)(d)),x(null)},j=e=>(0!==e||g!==te.length-1)&&!!Boolean(g>e);(0,d.useEffect)((()=>{o((0,P.gw)()),s()}),[]);const b=e=>{o((0,P.yT)(e)),n({status:e})};return(0,T.jsx)($.JY,{onDragEnd:A,onDragStart:e=>{const t=te.findIndex((t=>t===e.source.droppableId));p(e),x(t)},children:(0,T.jsx)("div",{className:"order-board",children:null===te||void 0===te?void 0:te.map(((e,d)=>{var s,o,h,p;return(0,T.jsx)("div",{className:"dnd-column",children:(0,T.jsx)(O,{title:e,onDragEnd:A,name:e,isDropDisabled:j(d),total:null===(s=l[e])||void 0===s?void 0:s.length,loading:c[e].loading,reloadCurrentOrder:b,statistic:r,children:(0,T.jsxs)(N.Ay,{onScroll:t=>((e,t)=>{const a=e.target.lastChild,d=e.target.clientHeight+e.target.scrollTop;a&&d>a.offsetTop+a.clientHeight+19.9&&c[t].meta.last_page>c[t].meta.current_page&&!c[t].loading&&(v(t),n({page:c[t].meta.current_page+1,perPage:5,status:t}))})(t,e),autoHeight:!0,autoHeightMin:"76vh",autoHeightMax:"76vh",autoHide:!0,id:e,children:[Boolean(c[e].loading&&!(null!==(o=l[e])&&void 0!==o&&o.length))?null===(p=F.L[e])||void 0===p?void 0:p.map((()=>(0,T.jsx)(z.A,{loading:!0}))):null===(h=l[e])||void 0===h?void 0:h.map(((e,d)=>(0,T.jsx)(T.Fragment,{children:(0,T.jsx)($.sx,{draggableId:e.id.toString(),index:d,children:(d,s)=>(0,T.jsx)("div",{ref:d.innerRef,...d.draggableProps,...d.dragHandleProps,children:(0,T.jsx)(ee,{data:e,goToEdit:t,goToShow:a,getInvoiceFile:i})})},e.id)}))),c[e].loading&&e===u&&(0,T.jsx)(Y.A,{indicator:(0,T.jsx)(E.A,{style:{fontSize:24},spin:!0})})]})})},e)}))})})};var de=a(59051),se=a.n(de),ne=a(48946),re=a(39362),ie=a.n(re);const{RangePicker:oe}=s.A,{TabPane:le}=n.A,ce=["all","new","accepted","ready","on_a_way","delivered","canceled"];function ue(){const e=(0,m.wA)(),t=(0,c.Zp)(),{t:a}=(0,j.B)(),{activeMenu:s}=(0,m.d4)((e=>e.menu),m.bN),{defaultCurrency:S}=(0,m.d4)((e=>e.currency),m.bN),{orders:D,meta:M,loading:$,params:O,layout:Y,boardItems:N,statistic:E}=(0,m.d4)((e=>e.sellerOrders),m.bN),[F,z]=(0,d.useState)(se()().subtract(1,"months"),se()()),B=null===s||void 0===s?void 0:s.data,H=d=>{e((0,_.Uy)()),e((0,A.X4)({url:`seller/orders/${d.id}`,id:"order_edit",name:a("edit.order")})),t(`/seller/orders/${d.id}`)},R=d=>{e((0,A.X4)({url:`seller/order/details/${d.id}`,id:"order_details",name:a("order.details")})),t(`/seller/order/details/${d.id}`)},[G,L]=(0,d.useState)([{title:a("id"),is_show:!0,dataIndex:"id",key:"id",sorter:!0},{title:a("client"),is_show:!0,dataIndex:"user",key:"user",render:e=>(0,T.jsxs)("div",{children:[null===e||void 0===e?void 0:e.firstname," ",null===e||void 0===e?void 0:e.lastname]})},{title:a("number.of.products"),is_show:!0,dataIndex:"order_details_count",key:"rate",render:e=>(0,T.jsxs)("div",{className:"text-lowercase",children:[e," ",a("products")]})},{title:a("amount"),is_show:!0,dataIndex:"price",key:"price",render:(e,t)=>{const a=e;return(0,w.A)(a,S.symbol)}},{title:a("payment.type"),is_show:!0,dataIndex:"transaction",key:"transaction",render:e=>{var t,d;return a(null===e||void 0===e||null===(t=e.payment_system)||void 0===t||null===(d=t.payment)||void 0===d?void 0:d.tag)||"-"}},{title:a("gift.recipient.name"),is_show:!0,dataIndex:"name",key:"name",render:e=>e||"-"},{title:a("gift.recipient.phone"),is_show:!0,dataIndex:"phone",key:"phone",render:e=>e||"-"},{title:a("created.at"),is_show:!0,dataIndex:"created_at",key:"created_at"},{title:a("options"),is_show:!0,key:"options",render:(e,t)=>(0,T.jsxs)(r.A,{children:[(0,T.jsx)(i.A,{icon:(0,T.jsx)(u.A,{}),onClick:()=>R(t)}),(0,T.jsx)(i.A,{type:"primary",icon:(0,T.jsx)(v.A,{}),onClick:()=>H(t),disabled:"delivered"===t.status||"canceled"===t.status})]})}]);(0,b.A)((()=>{var t,a;const d={search:null===B||void 0===B?void 0:B.search,sort:null===B||void 0===B?void 0:B.sort,column:null===B||void 0===B?void 0:B.column,perPage:null===B||void 0===B?void 0:B.perPage,page:null===B||void 0===B?void 0:B.page,user_id:null===B||void 0===B?void 0:B.user_id,status:null===B||void 0===B?void 0:B.status,date_from:(null===F||void 0===F||null===(t=F[0])||void 0===t?void 0:t.format("YYYY-MM-DD"))||null,date_to:(null===F||void 0===F||null===(a=F[1])||void 0===a?void 0:a.format("YYYY-MM-DD"))||null};"table"===Y&&B?e((0,P.Gb)(d)):B&&e((0,P.RX)(d))}),[B]),(0,d.useEffect)((()=>{if(null!==s&&void 0!==s&&s.refetch&&"table"===Y){const t={status:null,page:null===B||void 0===B?void 0:B.page,perPage:20};(0,m.vA)((()=>{e((0,P.Gb)(t)),e((0,A.km)(s))}))}}),[null===s||void 0===s?void 0:s.refetch,Y]);const V=(t,a)=>{e((0,A.Ok)({activeMenu:s,data:{...B,[a]:t}}))};const X=t=>{switch(t.status){case"new":e((0,P.wy)(t));break;case"accepted":e((0,P.tB)(t));break;case"ready":e((0,P.xR)(t));break;case"on_a_way":e((0,P.n7)(t));break;case"delivered":e((0,P.Cg)(t));break;case"canceled":e((0,P.xm)(t));break;default:console.log("Sorry, we are out of")}},K=()=>{X({status:"new"}),X({status:"accepted"}),X({status:"ready"}),X({status:"on_a_way"}),X({status:"delivered"}),X({status:"canceled"})};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(o.A,{children:(0,T.jsxs)(r.A,{className:"order-filter",children:[(0,T.jsx)(y.A,{style:{width:"100%"},defaultValue:null===B||void 0===B?void 0:B.search,resetSearch:!(null!==B&&void 0!==B&&B.search),placeholder:a("search"),handleChange:e=>V(e,"search")}),(0,T.jsx)(k.G,{placeholder:a("select.client"),fetchOptions:async function(e){const t={search:e,perPage:10};return I.A.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>({label:`${e.firstname} ${e.lastname}`,value:e.id})))}))},onSelect:e=>V(e.value,"user_id"),onDeselect:()=>V(null,"user_id"),style:{width:"100%"},value:null===B||void 0===B?void 0:B.user_id}),(0,T.jsx)(oe,{value:F,onChange:e=>{V((t=>{var a,d;return{...t,date_from:null===e||void 0===e||null===(a=e[0])||void 0===a?void 0:a.format("YYYY-MM-DD"),date_to:null===e||void 0===e||null===(d=e[1])||void 0===d?void 0:d.format("YYYY-MM-DD")}})),z(e)},disabledDate:e=>e&&e>se()().endOf("day"),style:{width:"100%"}}),(0,T.jsx)(i.A,{icon:(0,T.jsx)(h.A,{}),onClick:()=>{z({}),(0,m.vA)((()=>{e((0,P.gw)()),e((0,A.Ok)({activeMenu:s,data:null}))})),"board"===Y?K():e((0,P.Gb)({status:null,page:null===B||void 0===B?void 0:B.page,perPage:20}))},disabled:Boolean(!B),style:{width:"100%"},children:a("clear")}),(0,T.jsx)(i.A,{type:"primary",icon:(0,T.jsx)(p.A,{}),onClick:()=>{e((0,_.Uy)()),e((0,A.X4)({id:"order-add",url:"seller/orders/add",name:a("add.order")})),t("/seller/orders/add")},style:{width:"100%"},children:a("add.order")}),"board"!==Y&&(0,T.jsx)(C.A,{setColumns:L,columns:G})]})}),(0,T.jsxs)(n.A,{defaultActiveKey:Y,onTabClick:t=>e((0,P.ZJ)(t)),children:[(0,T.jsx)(n.A.TabPane,{tab:(0,T.jsxs)("span",{children:[(0,T.jsx)(g.A,{}),a("Board")]}),children:"board"===Y&&(0,T.jsx)(ae,{orders:D,goToEdit:H,goToShow:R,boardItems:N,meta:M,fetchOrderAllItem:K,fetchOrders:X,statistic:E,getInvoiceFile:function(e){let{id:t}=e;ne.A.orderExport(t).then((e=>{ie()(e,`invoice_${t}.pdf`,"application/pdf")}))}})},"board"),(0,T.jsx)(n.A.TabPane,{tab:(0,T.jsxs)("span",{children:[(0,T.jsx)(x.A,{}),a("List")]}),children:"table"===Y&&(0,T.jsxs)(o.A,{children:[(0,T.jsx)(n.A,{onChange:t=>{const a="all"===t?void 0:t;e((0,A.Ok)({activeMenu:s,data:{status:a}}))},type:"card",activeKey:null===B||void 0===B?void 0:B.status,children:ce.map((e=>(0,T.jsx)(le,{tab:a(e)},e)))}),(0,T.jsx)(l.A,{columns:null===G||void 0===G?void 0:G.filter((e=>e.is_show)),dataSource:D,loading:$,pagination:{pageSize:O.perPage,page:O.page,total:M.total,defaultCurrent:O.page},rowKey:e=>e.id,onChange:function(t,a){const{pageSize:d,current:n}=t,{field:r,order:i}=a,o=(0,f.A)(i);e((0,A.Ok)({activeMenu:s,data:{...B,perPage:d,page:n,column:r,sort:o}}))}})]})},"table")]})]})}},8168:(e,t,a)=>{function d(e){switch(e){case"ascend":return"asc";case"descend":return"desc"}}a.d(t,{A:()=>d})},8297:(e,t,a)=>{a.d(t,{A:()=>o});var d=a(9950),s=a(55902),n=a(41397),r=a(60767),i=a(44414);function o(e){let{handleChange:t,defaultValue:a,resetSearch:o,...l}=e;const[c,u]=(0,d.useState)(a),v=(0,d.useMemo)((()=>(0,n.debounce)((e=>{t(e)}),800)),[]);return(0,d.useEffect)((()=>{u(a)}),[o]),(0,i.jsx)(s.A,{value:c,onChange:e=>{const{value:t}=e.target;u(t.replace(/\s/g,"")),v(t.replace(/\s/g,""))},prefix:(0,i.jsx)(r.A,{}),...l})}},28645:(e,t,a)=>{a.d(t,{A:()=>h});var d=a(9950),s=a(66362),n=a(69216),r=a(80737),i=a(25933),o=a(57811),l=a(72906),c=a(70030),u=a(44414);const{Text:v}=s.A,h=e=>{let{columns:t=[],setColumns:a}=e;const{t:s}=(0,c.B)(),[h,p]=(0,d.useState)(!1),g=(0,u.jsx)(n.A,{children:null===t||void 0===t?void 0:t.map(((e,d)=>(0,u.jsx)(n.A.Item,{children:(0,u.jsxs)(r.A,{className:"d-flex justify-content-between",children:[(0,u.jsx)(v,{children:e.title}),(0,u.jsx)(i.A,{defaultChecked:!0,onClick:()=>{!function(e){const d=null===t||void 0===t?void 0:t.map((t=>(t.dataIndex===e.dataIndex&&(t.is_show=!(null!==t&&void 0!==t&&t.is_show)),t)));a(d)}(e)}})]})},d)))});return(0,u.jsx)(o.A,{overlay:g,trigger:["click"],onVisibleChange:e=>{p(e)},visible:h,children:(0,u.jsx)(l.A,{style:{fontSize:"26px"}})})}},47992:(e,t,a)=>{a.d(t,{G:()=>l});var d=a(9950),s=a(95491),n=a.n(s),r=a(99674),i=a(90650),o=a(44414);const l=e=>{let{fetchOptions:t,debounceTimeout:a=400,...s}=e;const[l,c]=(0,d.useState)(!1),[u,v]=(0,d.useState)([]),h=(0,d.useMemo)((()=>n()((e=>{v([]),c(!0),t(e).then((e=>{v(e),c(!1)}))}),a)),[t,a]);return(0,o.jsx)(r.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:h,notFoundContent:l?(0,o.jsx)(i.A,{size:"small"}):"no results",...s,options:u,onFocus:()=>{u.length||h("")}})}},48946:(e,t,a)=>{a.d(t,{A:()=>s});var d=a(82371);const s={orderExport:(e,t)=>d.A.get(`dashboard/user/export/order/${e}/pdf`,{params:t,responseType:"blob"})}},53774:(e,t,a)=>{function d(e){if(!e)return"0";return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$")+" "+Number(e).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")}a.d(t,{A:()=>d})},73041:(e,t,a)=>{a.d(t,{A:()=>r});var d=a(20567),s=a(80575),n=(a(9950),a(44414));const r=e=>{let{loading:t}=e;return(0,n.jsx)(d.A,{className:"order-card",children:(0,n.jsx)(s.A,{loading:t,avatar:!0,active:!0})})}},80415:(e,t,a)=>{a.d(t,{L:()=>d});const d={new:[1,2,3,4,5],accepted:[1,2,3,4,5],ready:[1,2,3,4,5],on_a_way:[1,2,3,4,5],delivered:[1,2,3,4,5],canceled:[1,2,3,4,5]}}}]);