"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[7598],{87598:(e,t,a)=>{a.r(t),a.d(t,{default:()=>I});var l=a(9950),i=a(87827),s=a(20567),r=a(87094),n=a(41988),d=a(55902),c=a(99674),o=a(25933),u=a(48538),m=a(90650),p=a(49348),h=a(28429),v=a(71999),g=a(98591),A=a(91854),j=a(74623),x=a(62572),y=a(63620),f=a(28264),b=a(70030),k=a(31281),w=a(72345),q=a(2777),_=a(44414);const I=()=>{var e;const{t:t}=(0,b.B)(),a=(0,h.Zp)(),I=(0,A.wA)(),{activeMenu:$}=(0,A.d4)((e=>e.menu),A.bN),[F,E]=(0,l.useState)(!1),[N,S]=(0,l.useState)([null===(e=$.data)||void 0===e?void 0:e.image]||0),[L]=i.A.useForm(),[O,V]=(0,l.useState)(!1),[B,C]=(0,l.useState)(null),{uuid:M}=(0,h.g)(),{defaultLang:P,languages:z}=(0,A.d4)((e=>e.formLang),A.bN);(0,l.useEffect)((()=>()=>{const e=L.getFieldsValue(!0);I((0,j.Ok)({activeMenu:$,data:e}))}),[]);const K=e=>({name:e,url:y.sE+e});function R(e){if(!e)return{};const{translations:t}=e,a=z.map((e=>{var a,l;return{[`title[${e.locale}]`]:null===(a=t.find((t=>t.locale===e.locale)))||void 0===a?void 0:a.title,[`description[${e.locale}]`]:null===(l=t.find((t=>t.locale===e.locale)))||void 0===l?void 0:l.description}}));return Object.assign({},...a)}return(0,l.useEffect)((()=>{var e;$.refetch&&(e=M,E(!0),x.A.getById(e).then((e=>{let t=e.data;const a={...t,...R(t),parent_id:{label:t.translation.title,value:t.parent_id,key:t.parent_id},images:K(t.img),keywords:t.keywords.split(",")};L.setFieldsValue(a),S([K(t.img)])})).finally((()=>{E(!1),I((0,j.km)($))})))}),[$.refetch]),(0,_.jsx)(s.A,{title:t("edit.category"),extra:(0,_.jsx)(v.A,{}),children:F?(0,_.jsx)("div",{className:"d-flex justify-content-center align-items-center py-5",children:(0,_.jsx)(m.A,{size:"large",className:"mt-5 pt-5"})}):(0,_.jsxs)(i.A,{name:"basic",layout:"vertical",onFinish:e=>{V(!0);const l={type:2,active:e.active?1:0,keywords:e.keywords.join(","),title:(0,k.A)(z,e,"title"),description:(0,k.A)(z,e,"description"),images:[N[0].name],parent_id:e.parent_id.value},i="catalog/categories";x.A.update(M,l).then((e=>{console.log("res",e),p.oR.success(t("successfully.updated")),I((0,j.EK)({...$,nextUrl:i})),I((0,f.jE)()),a(`/${i}`)})).catch((e=>C(e.response.data.params))).finally((()=>V(!1)))},initialValues:{parent_id:{title:"---",value:0,key:0},...$.data},form:L,onFinishFailed:e=>console.log(e),children:[(0,_.jsxs)(r.A,{gutter:12,children:[(0,_.jsx)(n.A,{span:12,children:z.map(((e,a)=>(0,_.jsx)(i.A.Item,{label:t("name"),name:`title[${e.locale}]`,help:B&&B[`title.${P}`]?B[`title.${P}`][0]:null,validateStatus:B?"error":"success",rules:[{required:e.locale===P,message:t("required")}],hidden:e.locale!==P,children:(0,_.jsx)(d.A,{})},e.title+a)))}),(0,_.jsx)(n.A,{span:12,children:z.map(((e,a)=>(0,_.jsx)(i.A.Item,{label:t("description"),name:`description[${e.locale}]`,rules:[{required:e.locale===P,message:t("required")}],hidden:e.locale!==P,children:(0,_.jsx)(g.A,{rows:4})},e.locale+a)))}),(0,_.jsx)(n.A,{span:12,children:(0,_.jsx)(i.A.Item,{label:t("keywords"),name:"keywords",rules:[{required:!0,message:t("required")}],children:(0,_.jsx)(c.A,{mode:"tags",style:{width:"100%"}})})}),(0,_.jsx)(n.A,{span:12,children:(0,_.jsx)(i.A.Item,{label:t("parent.category"),name:"parent_id",rules:[{required:!0,message:t("required")}],children:(0,_.jsx)(w.v,{fetchOptions:async function(){return x.A.getAll({perPage:100}).then((e=>e.data.map((e=>{var t,a;return{title:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id,children:null===(a=e.children)||void 0===a?void 0:a.map((e=>{var t,a;return{title:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id,children:null===(a=e.children)||void 0===a?void 0:a.map((e=>{var t;return{title:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id,disabled:!0}}))}}))}}))))}})})}),(0,_.jsx)(n.A,{span:4,children:(0,_.jsx)(i.A.Item,{label:t("image"),name:"images",rules:[{required:!0,message:t("required")}],children:(0,_.jsx)(q.A,{type:"categories",imageList:N,setImageList:S,form:L,multiple:!1})})}),(0,_.jsx)(n.A,{span:2,children:(0,_.jsx)(i.A.Item,{label:t("active"),name:"active",valuePropName:"checked",children:(0,_.jsx)(o.A,{})})})]}),(0,_.jsx)(u.A,{type:"primary",htmlType:"submit",loading:O,children:t("submit")})]})})}}}]);