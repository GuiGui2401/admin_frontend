"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[7292],{7292:(e,t,s)=>{s.r(t),s.d(t,{default:()=>N});var a=s(9950),n=s(28429),r=s(49348),l=s(87827),i=s(20567),d=s(87094),c=s(41988),u=s(99674),o=s(56952),m=s(33022),p=s(48538),h=s(90650),x=s(59051),f=s.n(x),A=s(91854),j=s(74623),g=s(35765),v=s(73439),Y=s(47992),y=s(67231),b=s(70030),M=s(62466),D=s(54218),q=s(44414);function N(){var e;const{t:t}=(0,b.B)(),{activeMenu:s}=(0,A.d4)((e=>e.menu),A.bN),x=(0,A.wA)(),{id:N}=(0,n.g)(),[w]=l.A.useForm(),I=(0,n.Zp)(),[S,O]=(0,a.useState)(!1),[k,F]=(0,a.useState)(!1),[C,V]=(0,a.useState)((null===(e=s.data)||void 0===e?void 0:e.image)||null);(0,a.useEffect)((()=>()=>{const e=w.getFieldsValue(!0),t=JSON.stringify(e.start),a=JSON.stringify(e.end),n={...e,start:t,end:a};x((0,j.Ok)({activeMenu:s,data:n}))}),[]),(0,a.useEffect)((()=>{s.refetch&&(F(!0),g.A.getById(N).then((e=>{let{data:t}=e;const s={price:t.price,type:t.type,products:t.products.map((e=>{var t;return{label:null===(t=e.product.translation)||void 0===t?void 0:t.title,value:e.id}})),start:f()(t.start,"YYYY-MM-DD"),end:f()(t.end,"YYYY-MM-DD"),image:(0,M.A)(t.img)};w.setFieldsValue(s),V((0,M.A)(t.img))})).finally((()=>{F(!1),x((0,j.km)(s))})))}),[s.refetch]);return(0,q.jsx)(i.A,{title:t("edit.discount"),className:"h-100",children:k?(0,q.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,q.jsx)(h.A,{size:"large",className:"py-5"})}):(0,q.jsxs)(l.A,{name:"discount-add",layout:"vertical",onFinish:e=>{const a={price:e.price,type:e.type,products:e.products.map((e=>e.value)),start:e.start?f()(e.start).format("YYYY-MM-DD"):void 0,end:e.end?f()(e.end).format("YYYY-MM-DD"):void 0,images:[null===C||void 0===C?void 0:C.name]};O(!0);const n="seller/discounts";g.A.update(N,a).then((()=>{r.oR.success(t("successfully.updated")),x((0,j.EK)({...s,nextUrl:n})),I(`/${n}`),x((0,v.X)({}))})).finally((()=>O(!1)))},form:w,initialValues:{...(()=>{var e;const t=s.data;if(null===(e=s.data)||void 0===e||!e.start)return t;const a=s.data.start,n=s.data.end;return{...t,start:f()(a,"YYYY-MM-DD"),end:f()(n,"YYYY-MM-DD")}})()},className:"d-flex flex-column h-100",children:[(0,q.jsxs)(d.A,{gutter:12,children:[(0,q.jsx)(c.A,{span:12,children:(0,q.jsx)(l.A.Item,{label:t("type"),name:"type",rules:[{required:!0,message:t("required")}],children:(0,q.jsxs)(u.A,{children:[(0,q.jsx)(u.A.Option,{value:"fix",children:t("fix")}),(0,q.jsx)(u.A.Option,{value:"percent",children:t("percent")})]})})}),(0,q.jsx)(c.A,{span:12,children:(0,q.jsx)(l.A.Item,{label:t("price"),name:"price",rules:[{required:!0,message:t("required")}],children:(0,q.jsx)(o.A,{min:0,className:"w-100"})})}),(0,q.jsx)(c.A,{span:24,children:(0,q.jsx)(l.A.Item,{label:t("image"),name:"image",rules:[{required:!0,message:t("required")}],children:(0,q.jsx)(D.A,{form:w,image:C,setImage:V,name:"image",type:"discounts"})})}),(0,q.jsx)(c.A,{span:6,children:(0,q.jsx)(l.A.Item,{label:t("start.date"),name:"start",rules:[{required:!0,message:t("requried")}],children:(0,q.jsx)(m.A,{className:"w-100",placeholder:"",disabledDate:e=>f()().add(-1,"days")>=e})})}),(0,q.jsx)(c.A,{span:6,children:(0,q.jsx)(l.A.Item,{label:t("end.date"),name:"end",rules:[{required:!0,message:t("required")}],children:(0,q.jsx)(m.A,{className:"w-100",placeholder:""})})}),(0,q.jsx)(c.A,{span:24,children:(0,q.jsx)(l.A.Item,{label:t("products"),name:"products",rules:[{required:!0,message:t("required")}],children:(0,q.jsx)(Y.G,{fetchOptions:async function(e){const t={search:e};return y.A.getAll(t).then((e=>e.data.map((e=>{var t,s;return{label:null===(t=e.product)||void 0===t||null===(s=t.translation)||void 0===s?void 0:s.title,value:e.id}}))))},mode:"multiple"})})})]}),(0,q.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,q.jsx)("div",{className:"pb-5",children:(0,q.jsx)(p.A,{type:"primary",htmlType:"submit",loading:S,children:t("submit")})})})]})})}},47992:(e,t,s)=>{s.d(t,{G:()=>c});var a=s(9950),n=s(95491),r=s.n(n),l=s(99674),i=s(90650),d=s(44414);const c=e=>{let{fetchOptions:t,debounceTimeout:s=400,...n}=e;const[c,u]=(0,a.useState)(!1),[o,m]=(0,a.useState)([]),p=(0,a.useMemo)((()=>r()((e=>{m([]),u(!0),t(e).then((e=>{m(e),u(!1)}))}),s)),[t,s]);return(0,d.jsx)(l.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:p,notFoundContent:c?(0,d.jsx)(i.A,{size:"small"}):"no results",...n,options:o,onFocus:()=>{o.length||p("")}})}}}]);