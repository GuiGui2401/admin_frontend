"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[3043],{33043:(e,r,t)=>{t.r(r),t.d(r,{default:()=>P});var s=t(9950),o=t(45359),n=t(87827),l=t(20567),i=t(28429),a=t(91854),d=t(70030),m=t(75482),c=t(73364),u=t(70364),v=t(82039),h=t(65820),p=t(74623),j=t(29597),x=t(59051),A=t.n(x),g=t(36537),f=t(33824),y=t(49348),_=t(44414);const{Step:b}=o.A;function P(){var e,r,t,x,P,w,E,q,I,F,S,N;const{t:C}=(0,d.B)(),[k]=n.A.useForm(),T=(0,h.s)(),L=(0,a.wA)(),H=(0,i.Zp)(),{activeMenu:O}=(0,a.d4)((e=>e.menu),a.bN),{settings:M}=(0,a.d4)((e=>e.globalSettings),a.bN),{defaultCurrency:V}=(0,a.d4)((e=>e.currency),a.bN),B=Number((null===(e=T.values)||void 0===e?void 0:e.step)||0),[Y,D]=(0,s.useState)(!1),[$,G]=(0,s.useState)((null===O||void 0===O||null===(r=O.data)||void 0===r?void 0:r.images)||[]),[J,R]=(0,s.useState)(null!==O&&void 0!==O&&null!==(t=O.data)&&void 0!==t&&t.location_from?{lat:parseFloat(null===O||void 0===O||null===(x=O.data)||void 0===x||null===(P=x.location_from)||void 0===P?void 0:P.latitude),lng:parseFloat(null===O||void 0===O||null===(w=O.data)||void 0===w||null===(E=w.location_from)||void 0===E?void 0:E.longitude)}:(0,j.A)(M)),[K,U]=(0,s.useState)(null!==O&&void 0!==O&&null!==(q=O.data)&&void 0!==q&&q.location_to?{lat:parseFloat(null===O||void 0===O||null===(I=O.data)||void 0===I||null===(F=I.location_to)||void 0===F?void 0:F.latitude),lng:parseFloat(null===O||void 0===O||null===(S=O.data)||void 0===S||null===(N=S.location_to)||void 0===N?void 0:N.longitude)}:(0,j.A)(M));(0,s.useEffect)((()=>()=>{const e=k.getFieldsValue(!0),r=JSON.stringify(e.delivery_date),t=JSON.stringify(e.delivery_time),s={...e,date:r,time:t};L((0,p.Ok)({activeMenu:O,data:s}))}),[]);const Z=()=>{const e=B+1;T.set("step",e)},z=()=>{const e=B-1;T.set("step",e)};return(0,_.jsxs)(l.A,{title:C("add.parcel.order"),children:[(0,_.jsx)(o.A,{current:B,onChange:e=>{T.set("step",e)},children:m.C.map((e=>(0,_.jsx)(b,{title:C(e.title)},e.title)))}),(0,_.jsx)("div",{className:"steps-content",children:(0,_.jsxs)(n.A,{form:k,name:"parcel-create",layout:"vertical",onFinish:e=>{var r,t;console.log("values => ",e),D(!0);const s={user_id:null===(r=e.user_from)||void 0===r?void 0:r.value,currency_id:null===V||void 0===V?void 0:V.id,type_id:null===(t=e.type)||void 0===t?void 0:t.value,rate:null===V||void 0===V?void 0:V.rate,phone_from:e.phone_from.toString(),username_from:e.username_from,address_from:{longitude:null===J||void 0===J?void 0:J.lng,latitude:null===J||void 0===J?void 0:J.lat,address:e.address_from,house:e.house_from,stage:e.stage_from,room:e.room_from},phone_to:e.phone_to.toString(),username_to:e.username_to,address_to:{longitude:null===K||void 0===K?void 0:K.lng,latitude:null===K||void 0===K?void 0:K.lat,address:e.address_to,house:e.house_to,stage:e.stage_to,room:e.room_to},delivery_date:A()(e.delivery_date).format("YYYY-MM-DD"),delivery_time:A()(e.delivery_time,"HH:mm").format("HH:mm"),note:e.note,images:$.map((e=>e.name))},o={payment_sys_id:e.payment_type.value};g.A.create(s).then((e=>function(e,r){const t="parcel-orders";g.A.transaction(e,r).then((()=>{L((0,f.xj)()),y.oR.success(C("successfully.created")),L((0,p.EK)({...O,nextUrl:t})),H(`/${t}`)})).finally((()=>D(!1)))}(e.data.id,o))).catch((()=>D(!1)))},initialValues:{...O.data},onFinishFailed:e=>{const r=["","",""];e.errorFields.map((e=>e.name[0])).forEach((e=>{e.includes("_from")?r[0]="sender.details.invalid":e.includes("_to")?r[1]="receiver.details.invalid":r[2]="parcel.details.invalid"})),r.forEach((e=>{e&&y.oR.error(C(e))}))},children:[(0,_.jsx)("div",{className:"First-content"===m.C[B].content?"":"d-none",children:(0,_.jsx)(c.A,{form:k,next:Z,location:J,setLocation:R})}),(0,_.jsx)("div",{className:"Second-content"===m.C[B].content?"":"d-none",children:(0,_.jsx)(u.A,{form:k,next:Z,prev:z,location:K,setLocation:U})}),(0,_.jsx)("div",{className:"Third-content"===m.C[B].content?"":"d-none",children:(0,_.jsx)(v.A,{form:k,loading:Y,prev:z,locationFrom:J,locationTo:K,image:$,setImage:G})})]})})]})}},53774:(e,r,t)=>{function s(e){if(!e)return"0";return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$")+" "+Number(e).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")}t.d(r,{A:()=>s})},70364:(e,r,t)=>{t.d(r,{A:()=>h});var s=t(9950),o=t(87094),n=t(41988),l=t(87827),i=t(55902),a=t(56952),d=t(80737),m=t(48538),c=t(70030),u=(t(79406),t(78498)),v=(t(53271),t(44414));const h=e=>{let{form:r,next:t,prev:h,location:p,setLocation:j}=e;const{t:x}=(0,c.B)(),[A,g]=(0,s.useState)(null),[f,y]=(0,s.useState)([]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(o.A,{gutter:24,children:[(0,v.jsxs)(n.A,{span:12,children:[(0,v.jsx)(l.A.Item,{label:x("username"),name:"username_to",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(x("no.empty.space"))):r&&(null===r||void 0===r?void 0:r.trim().length)<2?Promise.reject(new Error(x("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(x("required")))}],children:(0,v.jsx)(i.A,{})}),(0,v.jsx)(l.A.Item,{label:x("phone"),name:"phone_to",rules:[{validator:(e,r)=>r?r&&r<0?Promise.reject(new Error(x("must.be.positive"))):r&&(null===r||void 0===r?void 0:r.toString().length)<7?Promise.reject(new Error(x("min.7.numbers"))):Promise.resolve():Promise.reject(new Error(x("required")))}],children:(0,v.jsx)(a.A,{className:"w-100"})}),(0,v.jsxs)(o.A,{gutter:12,children:[(0,v.jsx)(n.A,{span:8,children:(0,v.jsx)(l.A.Item,{label:x("house"),name:"house_to",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(x("no.empty.space"))):Promise.resolve():Promise.reject(new Error(x("required")))}],children:(0,v.jsx)(i.A,{})})}),(0,v.jsx)(n.A,{span:8,children:(0,v.jsx)(l.A.Item,{label:x("stage"),name:"stage_to",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(x("no.empty.space"))):Promise.resolve():Promise.reject(new Error(x("required")))}],children:(0,v.jsx)(i.A,{})})}),(0,v.jsx)(n.A,{span:8,children:(0,v.jsx)(l.A.Item,{label:x("room"),name:"room_to",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(x("no.empty.space"))):Promise.resolve():Promise.reject(new Error(x("required")))}],children:(0,v.jsx)(i.A,{})})})]})]}),(0,v.jsxs)(n.A,{span:12,children:[(0,v.jsx)(l.A.Item,{label:x("address"),name:"address_to",rules:[{required:!0,message:x("required")}],children:(0,v.jsx)(i.A,{})}),(0,v.jsx)(u.A,{location:p,setLocation:j,setAddress:e=>r.setFieldsValue({address_to:e})})]})]}),(0,v.jsxs)(d.A,{children:[(0,v.jsx)(m.A,{type:"default",htmlType:"button",onClick:h,children:x("prev")}),(0,v.jsx)(m.A,{type:"primary",htmlType:"button",onClick:t,children:x("next")})]})]})}},73364:(e,r,t)=>{t.d(r,{A:()=>j});var s=t(9950),o=t(87094),n=t(41988),l=t(87827),i=t(55902),a=t(56952),d=t(80737),m=t(48538),c=t(70030),u=t(79406),v=t(78498),h=t(53271),p=t(44414);const j=e=>{let{form:r,next:t,location:j,setLocation:x}=e;const{t:A}=(0,c.B)(),[g,f]=(0,s.useState)(null),[y,_]=(0,s.useState)([]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(o.A,{gutter:24,children:[(0,p.jsxs)(n.A,{span:12,children:[(0,p.jsx)(l.A.Item,{label:A("user"),name:"user_from",rules:[{required:!0,message:A("required")}],children:(0,p.jsx)(u.a,{fetchOptions:async function(e){const r={search:e,roles:["user"],"empty-shop":1};return f(!1),h.A.search(r).then((e=>(_(e.data),e.data.map((e=>({label:[e.firstname,e.lastname].join(" "),value:e.id}))))))},refetch:g,onChange:e=>{const t=y.find((r=>r.id===e.value));r.setFieldsValue({username_from:[t.firstname,t.lastname].join(" "),phone_from:t.phone})}})}),(0,p.jsx)(l.A.Item,{label:A("username"),name:"username_from",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(A("no.empty.space"))):r&&(null===r||void 0===r?void 0:r.trim().length)<2?Promise.reject(new Error(A("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(A("required")))}],children:(0,p.jsx)(i.A,{})}),(0,p.jsx)(l.A.Item,{label:A("phone"),name:"phone_from",rules:[{validator:(e,r)=>r?r&&r<0?Promise.reject(new Error(A("must.be.positive"))):r&&(null===r||void 0===r?void 0:r.toString().length)<7?Promise.reject(new Error(A("min.7.numbers"))):Promise.resolve():Promise.reject(new Error(A("required")))}],children:(0,p.jsx)(a.A,{className:"w-100"})}),(0,p.jsxs)(o.A,{gutter:12,children:[(0,p.jsx)(n.A,{span:8,children:(0,p.jsx)(l.A.Item,{label:A("house"),name:"house_from",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(A("no.empty.space"))):Promise.resolve():Promise.reject(new Error(A("required")))}],children:(0,p.jsx)(i.A,{})})}),(0,p.jsx)(n.A,{span:8,children:(0,p.jsx)(l.A.Item,{label:A("stage"),name:"stage_from",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(A("no.empty.space"))):Promise.resolve():Promise.reject(new Error(A("required")))}],children:(0,p.jsx)(i.A,{})})}),(0,p.jsx)(n.A,{span:8,children:(0,p.jsx)(l.A.Item,{label:A("room"),name:"room_from",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(A("no.empty.space"))):Promise.resolve():Promise.reject(new Error(A("required")))}],children:(0,p.jsx)(i.A,{})})})]})]}),(0,p.jsxs)(n.A,{span:12,children:[(0,p.jsx)(l.A.Item,{label:A("address"),name:"address_from",rules:[{required:!0,message:A("required")}],children:(0,p.jsx)(i.A,{})}),(0,p.jsx)(v.A,{location:j,setLocation:x,setAddress:e=>r.setFieldsValue({address_from:e})})]})]}),(0,p.jsx)(d.A,{children:(0,p.jsx)(m.A,{type:"primary",htmlType:"button",onClick:t,children:A("next")})})]})}},75482:(e,r,t)=>{t.d(r,{C:()=>s});const s=[{title:"sender.details",content:"First-content"},{title:"receiver.details",content:"Second-content"},{title:"parcel.details",content:"Third-content"}]},82039:(e,r,t)=>{t.d(r,{A:()=>b});var s=t(9950),o=t(87094),n=t(41988),l=t(87827),i=t(33022),a=t(57796),d=t(55902),m=t(80737),c=t(48538),u=t(70030),v=t(2777),h=t(47992),p=t(51201),j=t(36537),x=t(53774),A=t(91854),g=t(59051),f=t.n(g),y=t(34996),_=t(44414);function b(e){var r;let{form:t,loading:g,prev:b,locationFrom:P,locationTo:w,image:E,setImage:q}=e;const{t:I}=(0,u.B)(),{activeMenu:F}=(0,A.d4)((e=>e.menu),A.bN),{payments:S}=(0,A.d4)((e=>e.payment),A.bN),[N,C]=(0,s.useState)(null===F||void 0===F||null===(r=F.data)||void 0===r?void 0:r.type),[k,T]=(0,s.useState)(0);(0,s.useEffect)((()=>{if(N&&P&&w){const e={"address_from[latitude]":P.lat,"address_from[longitude]":P.lng,"address_to[latitude]":w.lat,"address_to[longitude]":w.lng,type_id:null===N||void 0===N?void 0:N.value};j.A.calculate(e).then((e=>{let{data:r}=e;T(r.price)})).catch((e=>console.error(e)))}}),[N,P,w]);return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(o.A,{gutter:24,children:[(0,_.jsx)(n.A,{span:12,children:(0,_.jsx)(l.A.Item,{label:I("type"),name:"type",rules:[{required:!0,message:I("required")}],children:(0,_.jsx)(h.G,{fetchOptions:async function(e){const r={search:e};return p.A.getAll(r).then((e=>e.data.map((e=>({label:e.type,value:e.id})))))},onChange:e=>{C(e)}})})}),(0,_.jsx)(n.A,{span:12,children:(0,_.jsx)(l.A.Item,{label:I("image"),name:"images",rules:[{validator:()=>0===(null===E||void 0===E?void 0:E.length)?Promise.reject(new Error(I("required"))):Promise.resolve()}],children:(0,_.jsx)(v.A,{type:"languages",imageList:E,setImageList:q,form:t,multiple:!1})})}),(0,_.jsx)(n.A,{span:12,children:(0,_.jsx)(l.A.Item,{label:I("payment.type"),name:"payment_type",rules:[{required:!0,message:I("missing.payment.type")}],children:(0,_.jsx)(h.G,{fetchOptions:async function(e){const r={search:e};return y.A.getAll(r).then((e=>{var r,t;return null===(r=e.data)||void 0===r||null===(t=r.filter((e=>"cash"===e.tag||"wallet"===e.tag)))||void 0===t?void 0:t.map((e=>({label:I(e.tag),value:e.id})))}))}})})}),(0,_.jsx)(n.A,{span:12}),(0,_.jsx)(n.A,{span:12,children:(0,_.jsx)(l.A.Item,{label:I("delivery.date"),name:"delivery_date",rules:[{required:!0,message:I("required")}],children:(0,_.jsx)(i.A,{className:"w-100",placeholder:"",disabledDate:e=>f()().add(-1,"days")>=e})})}),(0,_.jsx)(n.A,{span:12,children:(0,_.jsx)(l.A.Item,{label:I("delivery.time"),name:"delivery_time",rules:[{required:!0,message:I("required")}],children:(0,_.jsx)(a.A,{className:"w-100",format:"HH:mm",placeholder:""})})}),(0,_.jsx)(n.A,{span:24,children:(0,_.jsx)(l.A.Item,{label:I("note"),name:"note",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(I("no.empty.space"))):r&&(null===r||void 0===r?void 0:r.trim().length)<2?Promise.reject(new Error(I("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(I("required")))}],children:(0,_.jsx)(d.A,{})})})]}),(0,_.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,_.jsxs)(m.A,{children:[(0,_.jsx)(c.A,{type:"default",htmlType:"button",onClick:b,children:I("prev")}),(0,_.jsx)(c.A,{type:"primary",htmlType:"submit",loading:g,disabled:!k,children:I("submit")})]}),(0,_.jsxs)(m.A,{children:[(0,_.jsxs)("span",{children:[I("total.price"),":"]}),(0,_.jsx)("span",{children:(0,x.A)(k)})]})]})]})}}}]);